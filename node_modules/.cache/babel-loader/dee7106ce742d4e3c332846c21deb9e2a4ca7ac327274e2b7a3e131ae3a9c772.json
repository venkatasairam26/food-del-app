{"ast":null,"code":"import _objectSpread from\"C:/Users/Venkata Sai Ram/OneDrive/Desktop/mern projects/food-del-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useEffect}from'react';import{useHistory}from'react-router-dom';import Cookies from'js-cookie';import'./index.css';import appUrl from'../../context/storeContext';import CartItems from'../CartItems';import Skeleton from'react-loading-skeleton';import'react-loading-skeleton/dist/skeleton.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const apiStatusContext={initial:\"INITIAL\",success:\"SUCCESS\",inProgress:\"PROGRESS\",failure:\"FAILURE\"};const Cart=()=>{const jwtToken=Cookies.get('jwt_token');const history=useHistory();const[cartItemsData,setCartItemsData]=useState({apiStatus:apiStatusContext.initial,data:[],errorMsg:null});useEffect(()=>{getCartItems();},[]);const getCartItems=async()=>{setCartItemsData(_objectSpread(_objectSpread({},cartItemsData),{},{apiStatus:apiStatusContext.inProgress}));const apiUrl=\"\".concat(appUrl,\"/cartItems\");const options={method:'GET',headers:{Authorization:\"Bearer \".concat(jwtToken)}};const response=await fetch(apiUrl,options);const data=await response.json();console.log(data);if(response.ok){setCartItemsData({apiStatus:apiStatusContext.success,data:data,errorMsg:null});}else{console.error('Failed to fetch cart items:',data.error);}};const onDeleteCartItem=async cartId=>{setCartItemsData(_objectSpread(_objectSpread({},cartItemsData),{},{apiStatus:apiStatusContext.inProgress}));const apiUrl=\"\".concat(appUrl,\"/cart/\").concat(cartId);const options={method:'DELETE',headers:{Authorization:\"Bearer \".concat(jwtToken)}};const response=await fetch(apiUrl,options);if(response.ok){setCartItemsData(_objectSpread(_objectSpread({},cartItemsData),{},{apiStatus:apiStatusContext.success,data:data,errorMsg:null}));getCartItems();console.log('Item removed from cart successfully');}else{console.error('Failed to remove item from cart:');}};const{data,apiStatus}=cartItemsData;const totalPrice=data.reduce((acc,item)=>acc+item.price*item.quantity,0);const renderContent=()=>{switch(apiStatus){case apiStatusContext.success:return data.length>0?/*#__PURE__*/_jsxs(\"ul\",{className:\"cart-items-list\",children:[data.map(item=>/*#__PURE__*/_jsx(CartItems,{cartItems:item,onDeleteCartItem:onDeleteCartItem},item.cartId)),/*#__PURE__*/_jsxs(\"li\",{className:\"total-price-item\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"total-price-text\",children:[\"Total Price: \\u20B9\",totalPrice]}),/*#__PURE__*/_jsx(\"button\",{className:\"checkout-button\",onClick:()=>history.push('/checkout'),children:\"Checkout\"})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"empty-cart-view\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"empty-cart-message\",children:\"Your cart is empty\"})});case apiStatusContext.failure:return/*#__PURE__*/_jsx(\"div\",{className:\"error-view\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"error-message\",children:\"Something went wrong. Please try again later.\"})});case apiStatusContext.inProgress:return/*#__PURE__*/_jsx(\"div\",{className:\"loading-view\",children:/*#__PURE__*/_jsx(\"ul\",{children:data.map(item=>/*#__PURE__*/_jsxs(\"li\",{className:\"cart-item\",children:[/*#__PURE__*/_jsx(Skeleton,{className:\"cart-skeleton\"}),/*#__PURE__*/_jsx(Skeleton,{className:\"cart-skeleton-2\"}),/*#__PURE__*/_jsx(Skeleton,{className:\"cart-skeleton-2\"}),/*#__PURE__*/_jsx(Skeleton,{className:\"cart-skeleton-2\"}),/*#__PURE__*/_jsx(Skeleton,{className:\"cart-skeleton-2\"})]},item.cartId))})});default:return null;}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"cart-text\",children:\"Cart\"}),renderContent()]});};export default Cart;","map":{"version":3,"names":["useState","useEffect","useHistory","Cookies","appUrl","CartItems","Skeleton","jsx","_jsx","jsxs","_jsxs","apiStatusContext","initial","success","inProgress","failure","Cart","jwtToken","get","history","cartItemsData","setCartItemsData","apiStatus","data","errorMsg","getCartItems","_objectSpread","apiUrl","concat","options","method","headers","Authorization","response","fetch","json","console","log","ok","error","onDeleteCartItem","cartId","totalPrice","reduce","acc","item","price","quantity","renderContent","length","className","children","map","cartItems","onClick","push"],"sources":["C:/Users/Venkata Sai Ram/OneDrive/Desktop/mern projects/food-del-frontend/src/components/cart/index.js"],"sourcesContent":["import { useState, useEffect } from 'react'\r\nimport { useHistory } from 'react-router-dom'\r\nimport Cookies from 'js-cookie'\r\nimport './index.css'\r\nimport appUrl from '../../context/storeContext'\r\nimport CartItems from '../CartItems'\r\nimport Skeleton from 'react-loading-skeleton'\r\nimport 'react-loading-skeleton/dist/skeleton.css'\r\n\r\nconst apiStatusContext = {\r\n  initial: \"INITIAL\",\r\n  success: \"SUCCESS\",\r\n  inProgress: \"PROGRESS\",\r\n  failure: \"FAILURE\"\r\n}\r\nconst Cart = () => {\r\n  const jwtToken = Cookies.get('jwt_token')\r\n  const history = useHistory()\r\n\r\n  const [cartItemsData, setCartItemsData] = useState({\r\n    apiStatus: apiStatusContext.initial,\r\n    data: [],\r\n    errorMsg: null\r\n  })\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    getCartItems()\r\n  }, [])\r\n\r\n  const getCartItems = async () => {\r\n    setCartItemsData({\r\n      ...cartItemsData,\r\n      apiStatus: apiStatusContext.inProgress\r\n    })\r\n\r\n    const apiUrl = `${appUrl}/cartItems`\r\n    const options = {\r\n      method: 'GET',\r\n      headers: {\r\n        Authorization: `Bearer ${jwtToken}`,\r\n      },\r\n    }\r\n    const response = await fetch(apiUrl, options)\r\n    const data = await response.json()\r\n    console.log(data)\r\n    if (response.ok) {\r\n      setCartItemsData({\r\n        apiStatus: apiStatusContext.success,\r\n        data: data,\r\n        errorMsg: null\r\n      })\r\n    } else {\r\n      console.error('Failed to fetch cart items:', data.error)\r\n    }\r\n  }\r\n\r\n  const onDeleteCartItem = async (cartId) => {\r\n    setCartItemsData({\r\n      ...cartItemsData,\r\n      apiStatus: apiStatusContext.inProgress\r\n    })\r\n    const apiUrl = `${appUrl}/cart/${cartId}`\r\n    const options = {\r\n      method: 'DELETE',\r\n      headers: {\r\n        Authorization: `Bearer ${jwtToken}`,\r\n      },\r\n    }\r\n    const response = await fetch(apiUrl, options)\r\n    \r\n    if (response.ok) {\r\n      setCartItemsData({\r\n        ...cartItemsData,\r\n        apiStatus: apiStatusContext.success,\r\n        data: data,\r\n        errorMsg: null\r\n      })\r\n      getCartItems()\r\n      console.log('Item removed from cart successfully')\r\n    } else {\r\n      console.error('Failed to remove item from cart:')\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  const { data, apiStatus } = cartItemsData\r\n  const totalPrice = data.reduce((acc, item) => acc + item.price * item.quantity, 0)\r\n  \r\n\r\n\r\n\r\n  const renderContent = () => {\r\n    switch (apiStatus) {\r\n      case apiStatusContext.success:\r\n        return (\r\n          data.length > 0 ? (<ul className='cart-items-list'>\r\n            {data.map(item => (\r\n              <CartItems\r\n                key={item.cartId}\r\n                cartItems={item}\r\n                onDeleteCartItem={onDeleteCartItem}\r\n              />\r\n            ))}\r\n            <li className='total-price-item'>\r\n              <h2 className='total-price-text'>Total Price: â‚¹{totalPrice}</h2>\r\n              <button className='checkout-button' onClick={()=>history.push('/checkout')}>Checkout</button>\r\n            </li>\r\n          </ul>) : (\r\n            <div className='empty-cart-view'>\r\n              <h1 className='empty-cart-message'>Your cart is empty</h1>\r\n            </div>\r\n          )\r\n        )\r\n      case apiStatusContext.failure:\r\n        return <div className='error-view'><h1 className='error-message'>Something went wrong. Please try again later.</h1></div>\r\n      case apiStatusContext.inProgress:\r\n        return <div className='loading-view'>\r\n          <ul>\r\n            {data.map(item => (\r\n              <li key={item.cartId} className='cart-item'>\r\n                <Skeleton className='cart-skeleton' />\r\n                <Skeleton className='cart-skeleton-2' />\r\n                <Skeleton className='cart-skeleton-2' />\r\n                <Skeleton className='cart-skeleton-2' />\r\n                <Skeleton className='cart-skeleton-2' />\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      default:\r\n        return null\r\n    }\r\n  }\r\n\r\n\r\n  return (\r\n    <div>\r\n      <h1 className='cart-text'>Cart</h1>\r\n      {renderContent()}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Cart\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}